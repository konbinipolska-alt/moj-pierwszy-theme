<div class="generic-section">
  <div class="generic-wrapper">
    {% for block in section.blocks %}
      <div class="generic-block" 
           style="
             {% if block.settings.background_color %}background-color: {{ block.settings.background_color }};{% endif %}
             {% if block.settings.background_image %}background-image: url('{{ block.settings.background_image | image_url: width: 1200 }}'); background-size: cover; background-position: center;{% endif %}
             padding: {{ block.settings.padding | default: 0 }}px;
           " 
           {{ block.shopify_attributes }}>
        {% if block.settings.link != blank %}
          <a href="{{ block.settings.link }}" class="block-link"></a>
        {% endif %}
        <div class="generic-block-content content-{{ block.settings.content_position | default: 'center-center' }}">
          {% if block.settings.header_link != blank %}
            <a href="{{ block.settings.header_link }}" class="header-link">
              <h2 class="generic-header" 
                  style="
                    {% if block.settings.header_color %}color: {{ block.settings.header_color }};{% endif %}
                    text-align: {{ block.settings.text_alignment | default: 'center' }};
                  ">
                {{ block.settings.header }}
              </h2>
            </a>
          {% elsif block.settings.header != blank %}
            <h2 class="generic-header" 
                style="
                  {% if block.settings.header_color %}color: {{ block.settings.header_color }};{% endif %}
                  text-align: {{ block.settings.text_alignment | default: 'center' }};
                ">
              {{ block.settings.header }}
            </h2>
          {% endif %}
          {% if block.settings.subheader != blank %}
            <p class="generic-subheader" 
               style="
                 {% if block.settings.subheader_color %}color: {{ block.settings.subheader_color }};{% endif %}
                 text-align: {{ block.settings.text_alignment | default: 'center' }};
                 margin-top: {{ block.settings.header_subheader_gap | default: 8 }}px;
               ">
              {{ block.settings.subheader }}
            </p>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<style>
  .generic-section {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    background-color: {{ section.settings.background_color | default: '#ffffff' }};
    overflow: hidden;
  }

  .generic-wrapper {
    width: 100%;
    padding: 48px;
    display: grid;
    {% if section.settings.size_mode == 'auto' %}
      grid-template-columns: repeat({{ section.settings.columns_per_row | default: 3 }}, 1fr);
      grid-auto-rows: auto;
    {% else %}
      grid-template-columns: repeat({{ section.settings.columns_per_row | default: 3 }}, minmax(0, {{ section.settings.block_width | default: 300 }}px));
      grid-auto-rows: {{ section.settings.block_height | default: 200 }}px;
    {% endif %}
    gap: {{ section.settings.gap | default: 48 }}px;
    box-sizing: border-box;
    {% if section.settings.size_mode == 'fixed' %}
      justify-content: center;
    {% endif %}
  }

  .generic-block {
    background-color: white;
    border: 1px solid #0b00b5;
    position: relative;
    {% if section.settings.size_mode == 'fixed' %}
      width: {{ section.settings.block_width | default: 300 }}px;
      height: {{ section.settings.block_height | default: 200 }}px;
      max-width: 100%;
    {% endif %}
  }

  .block-link {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 10;
  }

  .generic-block-content {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 5;
  }

  .content-left-top {
    justify-content: flex-start;
    align-items: flex-start;
  }

  .content-left-center {
    justify-content: center;
    align-items: flex-start;
  }

  .content-left-bottom {
    justify-content: flex-end;
    align-items: flex-start;
  }

  .content-center-top {
    justify-content: flex-start;
    align-items: center;
  }

  .content-center-center {
    justify-content: center;
    align-items: center;
  }

  .content-center-bottom {
    justify-content: flex-end;
    align-items: center;
  }

  .content-right-top {
    justify-content: flex-start;
    align-items: flex-end;
  }

  .content-right-center {
    justify-content: center;
    align-items: flex-end;
  }

  .content-right-bottom {
    justify-content: flex-end;
    align-items: flex-end;
  }

  .generic-header {
    font-family: 'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 1.5rem;
    font-weight: 600;
    color: #1f2937;
    margin: 0;
    width: 100%;
    text-align: center;
  }

  .generic-subheader {
    font-family: 'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 1rem;
    font-weight: 400;
    color: #6b7280;
    margin: 8px 0 0 0;
    width: 100%;
    text-align: center;
  }

  .header-link {
    text-decoration: none;
    width: 100%;
  }
</style>

{% schema %}
{
  "name": "Generic Section",
  "settings": [
    {
      "type": "color",
      "id": "background_color",
      "label": "Kolor tła",
      "default": "#ffffff"
    },
    {
      "type": "number",
      "id": "gap",
      "label": "Odstęp między blokami (px)",
      "default": 48
    },
    {
      "type": "number",
      "id": "columns_per_row",
      "label": "Ilość kolumn w rzędzie",
      "default": 3
    },
    {
      "type": "select",
      "id": "size_mode",
      "label": "Tryb wymiarów bloków",
      "options": [
        {
          "value": "auto",
          "label": "Auto (wypełniają przestrzeń)"
        },
        {
          "value": "fixed",
          "label": "Stałe wymiary w px"
        }
      ],
      "default": "auto"
    },
    {
      "type": "number",
      "id": "block_width",
      "label": "Szerokość bloku (px)",
      "default": 300,
      "info": "Tylko gdy tryb: stałe wymiary"
    },
    {
      "type": "number",
      "id": "block_height",
      "label": "Wysokość bloku (px)",
      "default": 200,
      "info": "Tylko gdy tryb: stałe wymiary"
    }
  ],
  "blocks": [
    {
      "type": "block",
      "name": "Blok",
      "settings": [
        {
          "type": "text",
          "id": "block_name",
          "label": "Nazwa bloku",
          "default": "Blok"
        },
        {
          "type": "header",
          "content": "Tło bloku"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Kolor tła"
        },
        {
          "type": "image_picker",
          "id": "background_image",
          "label": "Grafika tła"
        },
        {
          "type": "header",
          "content": "Zawartość"
        },
        {
          "type": "text",
          "id": "header",
          "label": "Header"
        },
        {
          "type": "url",
          "id": "header_link",
          "label": "Link headera"
        },
        {
          "type": "text",
          "id": "subheader",
          "label": "Subheader"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link całego bloku"
        },
        {
          "type": "number",
          "id": "padding",
          "label": "Marginesy wewnętrzne (px)",
          "default": 0
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "Pozycja zawartości",
          "options": [
            {
              "value": "left-top",
              "label": "Lewa góra"
            },
            {
              "value": "left-center",
              "label": "Lewa środek"
            },
            {
              "value": "left-bottom",
              "label": "Lewa dół"
            },
            {
              "value": "center-top",
              "label": "Środek góra"
            },
            {
              "value": "center-center",
              "label": "Środek środek"
            },
            {
              "value": "center-bottom",
              "label": "Środek dół"
            },
            {
              "value": "right-top",
              "label": "Prawa góra"
            },
            {
              "value": "right-center",
              "label": "Prawa środek"
            },
            {
              "value": "right-bottom",
              "label": "Prawa dół"
            }
          ],
          "default": "center-center"
        },
        {
          "type": "select",
          "id": "text_alignment",
          "label": "Wyrównanie tekstu",
          "options": [
            {
              "value": "left",
              "label": "Lewo"
            },
            {
              "value": "center",
              "label": "Środek"
            },
            {
              "value": "right",
              "label": "Prawo"
            }
          ],
          "default": "center"
        },
        {
          "type": "number",
          "id": "header_subheader_gap",
          "label": "Odstęp header - subheader (px)",
          "default": 8
        },
        {
          "type": "color",
          "id": "header_color",
          "label": "Kolor headera"
        },
        {
          "type": "color",
          "id": "subheader_color",
          "label": "Kolor subheadera"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Generic Section"
    }
  ]
}
{% endschema %}

